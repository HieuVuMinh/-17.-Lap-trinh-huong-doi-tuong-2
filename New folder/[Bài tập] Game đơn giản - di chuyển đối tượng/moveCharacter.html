<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body onload="docReady(); docReady1()">
<div>
    <canvas id="myCanvas" width="1520px" height="700" style="border: solid 1px #d3d3d3"></canvas>
</div>

<script>
    //test
    let game = "start";
    let frame = 0;


    // Background
    class bg {
        sX;
        sY;
        sW;
        sH;
        cX;
        cY;
        cW;
        cH;

        constructor(sX, sY, sW, sH, cX, cY, cW, cH) {
            this.sX = sX;
            this.sY = sY;
            this.sW = sW;
            this.sH = sH;
            this.cX = cX;
            this.cY = cY;
            this.cW = cW;
            this.cH = cH;
        }

        draw() {
            let image = new Image(128, 96);
            image.src = "109-Ad-Shadow01.png"
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX, this.cY, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 100, this.cY, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 200, this.cY, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 400, this.cY, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 600, this.cY, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 800, this.cY, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1000, this.cY, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1200, this.cY, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1400, this.cY, this.cW, this.cH)

            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX, this.cY + 200, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 100, this.cY + 200, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 200, this.cY + 200, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 400, this.cY + 200, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 600, this.cY + 200, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 800, this.cY + 200, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1000, this.cY + 200, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1200, this.cY + 200, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1400, this.cY + 200, this.cW, this.cH)

            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX, this.cY + 400, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 100, this.cY + 400, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 200, this.cY + 400, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 400, this.cY + 400, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 600, this.cY + 400, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 800, this.cY + 400, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1000, this.cY + 400, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1200, this.cY + 400, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1400, this.cY + 400, this.cW, this.cH)

            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX, this.cY + 600, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 100, this.cY + 600, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 200, this.cY + 600, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 400, this.cY + 600, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 600, this.cY + 600, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 800, this.cY + 600, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1000, this.cY + 600, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1200, this.cY + 600, this.cW, this.cH)
            ctx.drawImage(image, this.sX, this.sY, this.sW, this.sH, this.cX + 1400, this.cY + 600, this.cW, this.cH)
        }
    }

    // lớp Character
    class Character {
        image;
        sX;
        sY;
        sW;
        sH;
        cX;
        cY;
        cW;
        cH;

        constructor(sX, sY, sW, sH, cX, cY, cW, cH) {
            this.sX = sX;
            this.sY = sY;
            this.sW = sW;
            this.sH = sH;
            this.cX = cX;
            this.cY = cY;
            this.cW = cW;
            this.cH = cH;
            this.speed = 20;
        }

        drawCharacter(src) {
            this.image = new Image(48, 64);
            this.image.src = src
            ctx.drawImage(this.image, this.sX, this.sY, this.sW, this.sH, this.cX, this.cY, this.cW, this.cH)
        }

        moveRight() {
            this.cX += this.speed;
        }

        moveLeft() {
            this.cX -= this.speed;
        }

        moveUp() {
            this.cY -= this.speed;
        }

        moveDown() {
            this.cY += this.speed;
        }
    }

    //test
    // Lớp The Evil
    class TheEvil {
        image;
        cX;
        cY;

        constructor(cX, cY) {
            this.cX = cX;
            this.cY = cY;
            this.animate = [
                {sX: 69, sY: 0},
                {sX: 138, sY: 0},
                {sX: 207, sY: 0},
                {sX: 276, sY: 0}

            ]
            this.sW = 69;
            this.sH = 80;
            this.cW = 69;
            this.cH = 80;
            this.speed = 20;
            this.i = 0;
        }
        drawTheEvil(src){
            ctx.beginPath();
            this.image = new Image(69, 80);
            this.image.src = src
            if (game == "start"){
                if (frame % 16 ==0){
                    this.i++;
                    if(this.i > 3){
                        this.i = 0;
                    }
                }
            }
          ctx.drawImage(this.image, this.animate[this.i].sX, this.animate[this.i].sY, this.sW, this.sH,
                                  this.cX, this.cY, this.cW, this.cH)
        }
        moveRight1() {
            this.cX += this.speed;
        }

        moveLeft1() {
            this.cX -= this.speed;
        }

        moveUp1() {
            this.cY -= this.speed;
        }

        moveDown1() {
            this.cY += this.speed;
        }
    }

    //test
    function animate() {
        requestAnimationFrame(animate);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        frame++;
        Draw.draw();
        DrawCharacter.drawCharacter("418-Monster21.png");
        DrawTheEvil.drawTheEvil("1187-Azastral01.png");
    }

    // Khởi tạo đối tượng Back ground
    var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");
    let Draw = new bg(0, 0, 96, 128, 0, 0, 200, 200)
    Draw.draw();

    // Khởi tạo đối tượng The Monster
    let DrawCharacter = new Character(0, 0, 48, 64, 0, 0, 50, 64,)
    DrawCharacter.drawCharacter("418-Monster21.png");

    // Khởi tạo đối tượng The Evil
    let DrawTheEvil = new TheEvil(0,0);
    DrawTheEvil.drawTheEvil("1187-Azastral01.png");

    // Di chuyển đối tượng The Evil
    // Phải
    function moveRight1() {
        DrawTheEvil.sX = 0;
        DrawTheEvil.sY = 0;
        DrawTheEvil.sW = 69;
        DrawTheEvil.sH = 80;

        DrawTheEvil.moveRight1();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Draw.draw();
        DrawTheEvil.drawTheEvil("1187-Azastral01.png");
    }
    function moveLeft1() {
        DrawTheEvil.sX = 0;
        DrawTheEvil.sY = 0;
        DrawTheEvil.sW = 69;
        DrawTheEvil.sH = 80;

        DrawTheEvil.moveLeft1();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Draw.draw();
        DrawTheEvil.drawTheEvil("1187-Azastral01.png");
    }
    function moveUp1() {
        DrawTheEvil.sX = 0;
        DrawTheEvil.sY = 0;
        DrawTheEvil.sW = 69;
        DrawTheEvil.sH = 80;

        DrawTheEvil.moveUp1();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Draw.draw();
        DrawTheEvil.drawTheEvil("1187-Azastral01.png");
    }
    function moveDown1() {
        DrawTheEvil.sX = 0;
        DrawTheEvil.sY = 0;
        DrawTheEvil.sW = 69;
        DrawTheEvil.sH = 80;

        DrawTheEvil.moveDown1();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Draw.draw();
        DrawTheEvil.drawTheEvil("1187-Azastral01.png");
    }

    // Di chuyển đối tượng The Monster
    // Phải
    function moveRight() {
        DrawCharacter.sX = 0;
        DrawCharacter.sY = 128;
        DrawCharacter.sW = 48;
        DrawCharacter.sH = 64;

        DrawCharacter.moveRight();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Draw.draw();
        DrawCharacter.drawCharacter("418-Monster21.png");
    }

    // Trái
    function moveLeft() {
        DrawCharacter.sX = 0;
        DrawCharacter.sY = 64;
        DrawCharacter.sW = 48;
        DrawCharacter.sH = 64;

        DrawCharacter.moveLeft();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Draw.draw();
        DrawCharacter.drawCharacter("418-Monster21.png")
    }

    // Lên
    function moveUp() {
        DrawCharacter.sX = 0;
        DrawCharacter.sY = 192;
        DrawCharacter.sW = 48;
        DrawCharacter.sH = 64;

        DrawCharacter.moveUp();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Draw.draw();
        DrawCharacter.drawCharacter("418-Monster21.png")
    }

    // Xuống
    function moveDown() {
        DrawCharacter.sX = 0;
        DrawCharacter.sY = 0;
        DrawCharacter.sW = 48;
        DrawCharacter.sH = 64;

        DrawCharacter.moveDown();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        Draw.draw();
        DrawCharacter.drawCharacter("418-Monster21.png");
    }

    // function nhận bàn phím The Charater
    function moveSelection(evt) {
        switch (evt.keyCode) {
            case 37:
                moveLeft();
                break;
            case 39:
                moveRight();
                break;
            case 38:
                moveUp();
                break;
            case 40:
                moveDown();
                break;
        }
    }

    // function nhận bàn phím The Evil
    function moveSelection1(evt) {
        switch (evt.keyCode) {
            case 65:
                moveLeft1();
                break;
            case 68:
                moveRight1();
                break;
            case 87:
                moveUp1();
                break;
            case 83:
                moveDown1();
                break;
        }
    }


    function docReady() {
        window.addEventListener('keydown', moveSelection);
    }
    function docReady1() {
        window.addEventListener('keydown', moveSelection1);
    }

    animate()
</script>
</body>
</html>